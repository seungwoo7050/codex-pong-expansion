# v1.0.0 인프라 오버뷰

## 1. 목적
- 로컬/도커 실행, 모니터링, 리버스 프록시 구성을 v1.0.0 기준으로 요약해 클론 직후 바로 점검할 수 있도록 한다.

## 2. 구성 요소
- Docker Compose 서비스: `backend`, `frontend`, `db`(MariaDB), `redis`, `replay-worker`, `prometheus`, `grafana`, `nginx`.
- 공통 환경: `TZ=Asia/Seoul`, DB `utf8mb4_unicode_ci`, 모든 컨테이너 간 네트워크는 Compose 브리지 사용.
- 스토리지: 리플레이/익스포트는 `/data/replays` 네임드 볼륨 공유, DB는 `db_data` 볼륨.

## 3. 네트워킹/라우팅
- Nginx가 80 포트로 수신, 라우팅: `/api`/`/ws` → backend, 나머지는 frontend 정적 자산.
- WebSocket 타임아웃 120s, gzip 정적 자산 압축, 접근 로그는 응답 시간/유저 에이전트 포함 포맷.
- HTTPS 종단은 미포함(포트폴리오 데모용), 필요 시 인증서 마운트 후 `listen 443 ssl` 블록 추가.

## 4. 모니터링
- Prometheus가 backend/worker/Redis 기본 메트릭을 scrape(`infra/monitoring/prometheus.yml`).
- Grafana는 admin/admin 기본 계정, 대시보드 샘플은 요청 지표/WS 세션/잡 처리량 위주(`infra/monitoring/grafana/dashboards`).
- 알림 채널 연동은 미구성. 대시보드/데이터소스 프로비저닝만 포함.

## 5. 배포/운영 플로우
- 로컬/CI: `docker compose build && docker compose up -d`로 일괄 기동, 헬스체크는 `/api/health`.
- 백엔드 단독 실행 시 Redis/DB 연결 문자열을 동일 값(`db`, `redis`)으로 유지하거나 `.env`로 주입.
- worker는 `JOB_QUEUE_*` 값과 `REPLAY_STORAGE_PATH`가 backend와 일치해야 하며, ffmpeg가 PATH에 있어야 한다.

## 6. 안전/제한사항
- 도커 이미지에 실 비밀값 포함 금지: 기본 JWT 시크릿은 데모용이며 배포 시 교체 필요.
- SSL 종료/방화벽/레이트리밋은 포함되지 않았으므로 공개망 배포 시 인그레스 단 구성 추가 필요.
- 멀티 노드 스케일아웃(백엔드/워커 복수 인스턴스)은 검증되지 않았으며, Redis 단일 노드 전제를 가진다.
