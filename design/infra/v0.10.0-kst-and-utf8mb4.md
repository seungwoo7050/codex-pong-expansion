# v0.10.0 인프라 KST/utf8mb4 점검

## 1. 목적/범위
- 모든 컨테이너가 `TZ=Asia/Seoul`을 사용하도록 통일해 로그/메트릭 시각을 맞춘다.
- MariaDB와 애플리케이션 간 문자셋을 `utf8mb4_unicode_ci`로 고정해 한글/이모지가 깨지지 않도록 한다.
- Nginx/애플리케이션 레이어에서 한글 인코딩을 명시한다.

## 2. 주요 변경
- Docker Compose
  - `db`: `--collation-server=utf8mb4_unicode_ci`, `--skip-character-set-client-handshake` 옵션 추가.
  - `prometheus`, `nginx` 서비스에 `TZ=Asia/Seoul` 환경변수 추가(backend/frontend/db/redis/grafana는 기존 유지).
- 백엔드 설정
  - JDBC URL에 `useUnicode=true&characterEncoding=utf8mb4&serverTimezone=Asia/Seoul&connectionCollation=utf8mb4_unicode_ci` 추가.
  - `LocaleConfig`로 기본 TimeZone/Locale을 KST/ko_KR로 고정.
- Nginx
  - `charset utf-8;` 선언으로 정적 자산/헤더 한글 깨짐 방지.

## 3. 확인 시나리오
- Docker Compose 기동 후 `docker compose exec db mysql -e "SHOW VARIABLES LIKE 'collation_server';"` 결과가 `utf8mb4_unicode_ci`인지 확인.
- 백엔드 API 응답의 시간 필드에 `+09:00` 오프셋이 포함되는지 확인.
- 한글/이모지 닉네임을 포함한 소셜/채팅 데이터가 저장·조회 시 깨지지 않는지 수동 테스트.

## 4. 남은 과제
- 운영 배포 시 DB 초기화 스크립트에도 동일한 문자셋/콜레이션을 명시할 것.
- 로그 수집 파이프라인 도입 시 타임존 통일 여부를 모니터링 지표에 반영.
