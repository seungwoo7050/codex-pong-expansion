# v0.7.0 프론트엔드 설계 – 토너먼트 UI

## 1. 개요
- 목표: 토너먼트 생성/참여/시작 흐름과 단순 브래킷 뷰를 SPA 내에서 제공한다.
- 주요 화면: `/tournaments` 보호 라우트.
- 기술 스택: React + TypeScript, REST 호출(apiFetch), WebSocket(useTournamentSocket).

## 2. 화면 흐름
- 헤더 내 네비게이션에 "토너먼트" 항목 추가.
- `TournamentPage`
  - 생성 패널: 이름 입력, 인원(기본 8) 선택 후 생성 버튼 → POST `/api/tournaments`.
  - 목록 패널: `GET /api/tournaments` 응답으로 카드 렌더링, 보기/참여/시작 버튼 제공.
  - 상세/브래킷 패널: 선택된 토너먼트의 참가자 리스트와 라운드별 매치 카드 표시. roomId 표시로 게임 페이지 이동 단서 제공.
  - 상태 메시지: 오류/알림을 하단에 노출.

## 3. 상태 및 데이터 모델
- 타입 정의(`shared/types/tournament.ts`)
  - `TournamentSummary`: id, name, creatorId, status, maxParticipants, currentParticipants.
  - `TournamentDetail`: id, name, creatorId, status, maxParticipants, participants[], matches[].
  - `TournamentMatch`: round, position, status, roomId, scores, winnerId 등.
- 상태 관리
  - 로컬 state로 리스트/상세/폼 상태 관리.
  - WebSocket 알림 수신 시 상세/목록을 갱신.

## 4. 통신 규약
- REST
  - 생성: POST `/api/tournaments` { name, maxParticipants }
  - 참여: POST `/api/tournaments/{id}/join`
  - 시작: POST `/api/tournaments/{id}/start`
  - 조회: GET `/api/tournaments`, GET `/api/tournaments/{id}`
- WebSocket `/ws/tournament?token=<JWT>`
  - `TOURNAMENT_UPDATED/STARTED/COMPLETED`: payload = TournamentDetail
  - `TOURNAMENT_MATCH_READY`: payload = { tournamentId, matchId, roomId, round }

## 5. UI 컴포넌트
- `useTournamentSocket`
  - 연결 상태 플래그(connected) 제공, 수신 메시지를 콜백으로 전달.
- `TournamentPage`
  - 라운드별 그룹화를 useMemo로 수행, `bracket`, `bracket-round`, `bracket-match` 클래스 스타일 적용.
  - 시작 버튼은 creatorId && status=REGISTRATION일 때만 노출.

## 6. 테스트 계획
- `TournamentPage.test.tsx`
  - fetch/WebSocket 모킹 후: 생성 → 상세 렌더링 → 참여 → 시작 → roomId 출력까지 시나리오 검증.
  - 버튼 클릭 시 적절한 endpoint 호출 여부 확인.

## 7. 향후 확장
- 더블 엘리미네이션/체크인 기능은 후속 버전에서 고려.
- roomId 클릭 시 자동 게임 페이지 이동, 관전자 뷰 등은 v0.8.0 이후 연계 예정.
