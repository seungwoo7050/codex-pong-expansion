# v0.8.0 프런트엔드 설계 – 관전 전용 UI

## 1. 개요
- 목표: 실시간 경기 관전 전용 화면을 제공하고, 친구/리더보드/관전 목록에서 바로 진입할 수 있도록 한다.
- 범위: `SpectatorPage` 신설, `FriendsPage`/`LeaderboardPage` 관전 버튼 추가, `useGameSocket` 확장.
- 기본 전제: 관전자는 입력을 보내지 않으며, 서버에서 전달하는 `audienceRole`, `spectatorCount`를 표시한다.

## 2. 화면 구조
- 네비게이션: 상단 바에 `관전` 메뉴 추가 → `/spectate` 경로.
- `SpectatorPage`
  - 관전 목록 패널: `/api/match/ongoing` 결과를 리스트로 보여주고 방 선택 시 쿼리 파라미터 `roomId` 설정.
  - 관전 뷰 패널: `useGameSocket(roomId, token, 'SPECTATOR')`로 수신한 스냅샷을 캔버스 스타일로 렌더링, 관전자 수/연결 상태/타입을 표시.
  - 새로고침 버튼: `useLiveMatches`가 5초 주기로 갱신하며, 수동 갱신 버튼 제공.
- 친구/리더보드 진입점
  - `FriendsPage`: 친구 항목 우측에 "관전" 버튼을 추가, 해당 친구가 진행 중인 방을 찾으면 `/spectate?roomId=...`로 이동.
  - `LeaderboardPage`: 리더보드 플레이어가 게임 중이면 "관전하기" 버튼을 노출.

## 3. 상태 관리 및 데이터 소스
- `useLiveMatches`
  - 역할: 진행 중인 방 목록을 주기적으로 조회하여 관전 버튼 활성화 여부를 결정.
  - 주기: 5초, 오류 시 한국어 에러 메시지를 보여주고 버튼으로 재시도.
- `useGameSocket`
  - 확장: `audience` 파라미터 추가(기본 PLAYER), 수신 메시지의 `audienceRole`/`spectatorCount`를 상태로 노출.
  - 관전자 모드일 때 `sendInput`은 no-op 처리.

## 4. 주요 UI 정책
- 관전 목록 표시: roomId, 좌/우 닉네임, 매치 타입, `spectatorCount/Limit`를 모두 노출해 혼잡도를 안내.
- 오류 표시: 진행 중 경기 조회 실패 시 패널 상단에 에러 텍스트, WebSocket 실패 시 GamePage/SpectatorPage 각각의 에러 메시지 재사용.
- 접근 제어: 모든 관전 화면은 인증 보호 라우트 하에 둔다.

## 5. 테스트 전략
- 기존 `FriendsPage.test`에서 새로운 fetch(`/api/match/ongoing`) 응답을 모킹하여 관전 훅 호출 시 에러가 발생하지 않도록 유지.
- 관전 UI 자체는 실시간 스냅샷 렌더링 의존도가 높아 스냅샷 모킹과 시각적 확인을 병행(로컬). 필요 시 `useGameSocket`을 모킹한 렌더 스냅샷 테스트 추가 예정.
